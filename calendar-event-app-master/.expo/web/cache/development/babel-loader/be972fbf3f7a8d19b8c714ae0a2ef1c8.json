{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nvar _react = _interopRequireDefault(require(\"react\"));\nvar _dateutils = require(\"../../dateutils\");\nvar _xdate = _interopRequireDefault(require(\"xdate\"));\nvar _interface = require(\"../../interface\");\nvar commons = require(\"../commons\");\nvar UPDATE_SOURCES = commons.UPDATE_SOURCES;\nvar NUMBER_OF_PAGES = 2;\nvar Presenter = function () {\n  function Presenter() {\n    var _this = this;\n    (0, _classCallCheck2.default)(this, Presenter);\n    this.scrollToIndex = function (animated) {\n      _this.list.current.scrollToIndex({\n        animated: animated,\n        index: NUMBER_OF_PAGES\n      });\n    };\n    this.isSameWeek = function (date, prevDate, firstDay) {\n      return (0, _dateutils.sameWeek)(date, prevDate, firstDay);\n    };\n    this.onDayPressed = function (context, value) {\n      _lodash.default.invoke(context, 'setDate', value.dateString, UPDATE_SOURCES.DAY_PRESS);\n    };\n    this.onScroll = function (_ref) {\n      var context = _ref.context,\n        updateState = _ref.updateState,\n        x = _ref.x,\n        page = _ref.page,\n        items = _ref.items,\n        width = _ref.width;\n      if (!_this._firstAndroidRTLScrollIgnored) {\n        _this._firstAndroidRTLScrollIgnored = true;\n        return;\n      }\n      x = _this._getX(x, items == null ? void 0 : items.length, width);\n      var newPage = _this._getNewPage(x, width);\n      if (_this._shouldUpdateState(page)) {\n        _lodash.default.invoke(context, 'setDate', items[newPage], UPDATE_SOURCES.WEEK_SCROLL);\n        var data = _this._getItemsForPage(page, items);\n        updateState(data, newPage);\n      }\n    };\n    this.onMomentumScrollEnd = function (_ref2) {\n      var items = _ref2.items,\n        props = _ref2.props,\n        page = _ref2.page,\n        updateItems = _ref2.updateItems;\n      if (_this._isFirstPage(page) || _this._isLastPage(page, items)) {\n        _this.scrollToIndex(false);\n        var newWeekArray = _this.getDatesArray(props);\n        var updatedItems;\n        if (_this._isLastPage(page, items)) {\n          updatedItems = _this._mergeArraysFromEnd(items, newWeekArray);\n        } else {\n          updatedItems = _this._mergeArraysFromTop(items, newWeekArray);\n        }\n        updateItems(updatedItems);\n      }\n    };\n    this.shouldComponentUpdate = function (context, prevContext) {\n      var date = context.date,\n        updateSource = context.updateSource;\n      return date !== prevContext.date && updateSource !== UPDATE_SOURCES.WEEK_SCROLL;\n    };\n    this.getDatesArray = function (args) {\n      var array = [];\n      for (var index = -NUMBER_OF_PAGES; index <= NUMBER_OF_PAGES; index++) {\n        var d = _this.getDate(args, index);\n        array.push(d);\n      }\n      return array;\n    };\n    this._shouldUpdateState = function (page, newPage) {\n      return page !== newPage;\n    };\n    this._getX = function (x, itemsCount, containerWidth) {\n      if (_this._applyAndroidRtlFix) {\n        var numberOfPages = itemsCount - 1;\n        var overallWidth = numberOfPages * containerWidth;\n        return overallWidth - x;\n      }\n      return x;\n    };\n    this._getNewPage = function (x, containerWidth) {\n      return Math.round(x / containerWidth);\n    };\n    this._isFirstPage = function (page) {\n      return page === 0;\n    };\n    this._isLastPage = function (page, items) {\n      return page === items.length - 1;\n    };\n    this._getNexPageItems = function (items) {\n      return items.map(function (_, i) {\n        var index = i <= NUMBER_OF_PAGES ? i + NUMBER_OF_PAGES : i;\n        return items[index];\n      });\n    };\n    this._getFirstPageItems = function (items) {\n      return items.map(function (_, i) {\n        var index = i >= NUMBER_OF_PAGES ? i - NUMBER_OF_PAGES : i;\n        return items[index];\n      });\n    };\n    this._mergeArraysFromEnd = function (items, newArray) {\n      for (var i = NUMBER_OF_PAGES + 1; i < items.length; i++) {\n        items[i] = newArray[i];\n      }\n      return items;\n    };\n    this._mergeArraysFromTop = function (items, newArray) {\n      for (var i = 0; i < NUMBER_OF_PAGES; i++) {\n        items[i] = newArray[i];\n      }\n      return items;\n    };\n    this._getItemsForPage = function (page, items) {\n      if (_this._isLastPage(page, items)) {\n        return _this._getNexPageItems(items);\n      } else if (_this._isFirstPage(page)) {\n        return _this._getFirstPageItems(items);\n      }\n      return items;\n    };\n    this.list = _react.default.createRef();\n    this._applyAndroidRtlFix = commons.isAndroid && commons.isRTL;\n    this._firstAndroidRTLScrollIgnored = !this._applyAndroidRtlFix;\n  }\n  (0, _createClass2.default)(Presenter, [{\n    key: \"getDate\",\n    value: function getDate(_ref3, weekIndex) {\n      var current = _ref3.current,\n        context = _ref3.context,\n        firstDay = _ref3.firstDay;\n      var d = (0, _xdate.default)(current || context.date);\n      var dayOfTheWeek = d.getDay();\n      if (dayOfTheWeek < firstDay && firstDay > 0) {\n        dayOfTheWeek = 7 + dayOfTheWeek;\n      }\n      var dd = weekIndex === 0 ? d : d.addDays(firstDay - dayOfTheWeek);\n      var newDate = dd.addWeeks(weekIndex);\n      return (0, _interface.toMarkingFormat)(newDate);\n    }\n  }]);\n  return Presenter;\n}();\nvar _default = Presenter;\nexports.default = _default;","map":{"version":3,"names":["commons","require","UPDATE_SOURCES","NUMBER_OF_PAGES","Presenter","scrollToIndex","animated","list","current","index","isSameWeek","date","prevDate","firstDay","sameWeek","onDayPressed","context","value","_","invoke","dateString","DAY_PRESS","onScroll","updateState","x","page","items","width","_firstAndroidRTLScrollIgnored","_getX","length","newPage","_getNewPage","_shouldUpdateState","WEEK_SCROLL","data","_getItemsForPage","onMomentumScrollEnd","props","updateItems","_isFirstPage","_isLastPage","newWeekArray","getDatesArray","updatedItems","_mergeArraysFromEnd","_mergeArraysFromTop","shouldComponentUpdate","prevContext","updateSource","args","array","d","getDate","push","itemsCount","containerWidth","_applyAndroidRtlFix","numberOfPages","overallWidth","Math","round","_getNexPageItems","map","i","_getFirstPageItems","newArray","React","createRef","isAndroid","isRTL","weekIndex","XDate","dayOfTheWeek","getDay","dd","addDays","newDate","addWeeks","toMarkingFormat"],"sources":["E:/work/PK WORK/calendar-event-app-master/calendar-event-app-master/node_modules/react-native-calendars/src/expandableCalendar/WeekCalendar/presenter.js"],"sourcesContent":["import _ from 'lodash';\nimport React from 'react';\nimport {sameWeek} from '../../dateutils';\nconst commons = require('../commons');\nimport XDate from 'xdate';\nimport {toMarkingFormat} from '../../interface';\n\nconst UPDATE_SOURCES = commons.UPDATE_SOURCES;\n// must be a positive number\nconst NUMBER_OF_PAGES = 2;\n\nclass Presenter {\n  constructor() {\n    this.list = React.createRef();\n    this._applyAndroidRtlFix = commons.isAndroid && commons.isRTL;\n    // On Android+RTL there's an initial scroll that cause issues\n    this._firstAndroidRTLScrollIgnored = !this._applyAndroidRtlFix;\n  }\n\n  scrollToIndex = animated => {\n    this.list.current.scrollToIndex({animated, index: NUMBER_OF_PAGES});\n  };\n\n  isSameWeek = (date, prevDate, firstDay) => {\n    return sameWeek(date, prevDate, firstDay);\n  };\n\n  // Events\n\n  onDayPressed = (context, value) => {\n    _.invoke(context, 'setDate', value.dateString, UPDATE_SOURCES.DAY_PRESS);\n  };\n\n  onScroll = ({context, updateState, x, page, items, width}) => {\n    if (!this._firstAndroidRTLScrollIgnored) {\n      this._firstAndroidRTLScrollIgnored = true;\n      return;\n    }\n\n    x = this._getX(x, items?.length, width);\n    const newPage = this._getNewPage(x, width);\n\n    if (this._shouldUpdateState(page)) {\n      _.invoke(context, 'setDate', items[newPage], UPDATE_SOURCES.WEEK_SCROLL);\n      const data = this._getItemsForPage(page, items);\n      updateState(data, newPage);\n    }\n  };\n\n  onMomentumScrollEnd = ({items, props, page, updateItems}) => {\n    if (this._isFirstPage(page) || this._isLastPage(page, items)) {\n      this.scrollToIndex(false);\n\n      const newWeekArray = this.getDatesArray(props);\n      let updatedItems;\n      if (this._isLastPage(page, items)) {\n        updatedItems = this._mergeArraysFromEnd(items, newWeekArray);\n      } else {\n        updatedItems = this._mergeArraysFromTop(items, newWeekArray);\n      }\n\n      updateItems(updatedItems);\n    }\n  };\n\n  shouldComponentUpdate = (context, prevContext) => {\n    const {date, updateSource} = context;\n    return (\n      date !== prevContext.date &&\n      updateSource !== UPDATE_SOURCES.WEEK_SCROLL\n    );\n  };\n\n  getDate({current, context, firstDay}, weekIndex) {\n    const d = XDate(current || context.date);\n    // get the first day of the week as date (for the on scroll mark)\n    let dayOfTheWeek = d.getDay();\n    if (dayOfTheWeek < firstDay && firstDay > 0) {\n      dayOfTheWeek = 7 + dayOfTheWeek;\n    }\n\n    // leave the current date in the visible week as is\n    const dd = weekIndex === 0 ? d : d.addDays(firstDay - dayOfTheWeek);\n    const newDate = dd.addWeeks(weekIndex);\n    return toMarkingFormat(newDate);\n  }\n\n  getDatesArray = args => {\n    const array = [];\n    for (let index = -NUMBER_OF_PAGES; index <= NUMBER_OF_PAGES; index++) {\n      const d = this.getDate(args, index);\n      array.push(d);\n    }\n    return array;\n  };\n\n  _shouldUpdateState = (page, newPage) => {\n    return page !== newPage;\n  };\n\n  _getX = (x, itemsCount, containerWidth) => {\n    if (this._applyAndroidRtlFix) {\n      const numberOfPages = itemsCount - 1;\n      const overallWidth = numberOfPages * containerWidth;\n      return overallWidth - x;\n    }\n    return x;\n  };\n\n  _getNewPage = (x, containerWidth) => {\n    return Math.round(x / containerWidth);\n  };\n\n  _isFirstPage = page => {\n    return page === 0;\n  };\n\n  _isLastPage = (page, items) => {\n    return page === items.length - 1;\n  };\n\n  _getNexPageItems = items => {\n    return items.map((_, i) => {\n      const index = i <= NUMBER_OF_PAGES ? i + NUMBER_OF_PAGES : i;\n      return items[index];\n    });\n  };\n\n  _getFirstPageItems = items => {\n    return items.map((_, i) => {\n      const index = i >= NUMBER_OF_PAGES ? i - NUMBER_OF_PAGES : i;\n      return items[index];\n    });\n  };\n\n  _mergeArraysFromEnd = (items, newArray) => {\n    for (let i = NUMBER_OF_PAGES + 1; i < items.length; i++) {\n      items[i] = newArray[i];\n    }\n    return items;\n  };\n\n  _mergeArraysFromTop = (items, newArray) => {\n    for (let i = 0; i < NUMBER_OF_PAGES; i++) {\n      items[i] = newArray[i];\n    }\n    return items;\n  };\n\n  _getItemsForPage = (page, items) => {\n    if (this._isLastPage(page, items)) {\n      return this._getNexPageItems(items);\n    } else if (this._isFirstPage(page)) {\n      return this._getFirstPageItems(items);\n    }\n    return items;\n  };\n}\n\nexport default Presenter;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}